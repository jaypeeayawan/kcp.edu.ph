jQuery(document).ready(function (e) { var r = 0, l = !1, s = 0, a = "", d = "ontouchstart" in window || window.DocumentTouch && document instanceof DocumentTouch ? "touchstart" : "hover"; if (jQuery("#learndash_course_builder_box_wrap").length && (r = jQuery("#learndash_course_builder_box_wrap").data("ld-course-id")), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").length) { if (jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container").each(function (e, r) { 0 == e ? jQuery(".learndash-selector-post-listing", r).slideDown("slow", function () { jQuery(".learndash-selector-header .ld-course-builder-action-show-hide", r).removeClass("ld-course-builder-action-show"), jQuery(".learndash-selector-header .ld-course-builder-action-show-hide", r).addClass("ld-course-builder-action-hide") }) : (jQuery(".learndash-selector-post-listing", r).hide(), jQuery(".learndash-selector-header .ld-course-builder-action-show-hide", r).addClass("ld-course-builder-action-show"), jQuery(".learndash-selector-header .ld-course-builder-action-show-hide", r).removeClass("ld-course-builder-action-hide")); var l = jQuery(r).data("ld-type"); void 0 !== l && (Q(l), v(l)) }), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("click", ".ld-course-builder-action-show-hide", function (e, r) { e.stopImmediatePropagation(); var l = jQuery(e.currentTarget).parents("h3"), s = jQuery(l).parent(), a = jQuery(s).find(".learndash-selector-post-listing"); (void 0 === r || "open" != r && "close" != r) && (r = jQuery(a).is(":visible") ? "close" : "open"); "open" == r ? jQuery(a).slideDown("slow", function () { jQuery(e.currentTarget).removeClass("ld-course-builder-action-show"), jQuery(e.currentTarget).addClass("ld-course-builder-action-hide") }) : jQuery(a).slideUp("slow", function () { jQuery(e.currentTarget).addClass("ld-course-builder-action-show"), jQuery(e.currentTarget).removeClass("ld-course-builder-action-hide") }) }), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("click", "li", function (e) { !function (e) { if ("" !== e) { var r = jQuery(e).closest(".learndash-selector-container"); if (void 0 !== r) { var l = jQuery(r).data("ld-type") } } }(e.currentTarget); jQuery(e.currentTarget).hasClass("ld-disabled") ? jQuery(e.currentTarget).removeClass("ld-selected") : jQuery(e.currentTarget).hasClass("ld-selected") ? jQuery(e.currentTarget).removeClass("ld-selected") : jQuery(e.currentTarget).addClass("ld-selected") }), jQuery("#learndash_course_builder_box_wrap").on("click", ".learndash_selectors .pager-info button", function (e) { e.stopImmediatePropagation(); var l = jQuery(e.currentTarget).parents(".learndash-selector-container"); if (void 0 !== l) { var s = jQuery(l).data("ld-type"); if (void 0 !== s) { var a = jQuery(e.currentTarget).data("page"); void 0 === s && (a = 1), t = l, i = { action: "learndash_course_builder_selector_pager", course_id: r, query_args: { post_type: d = s, paged: a } }, jQuery.ajax({ type: "POST", url: ajaxurl, dataType: "json", cache: !1, data: i, error: function (e, r, l) { }, success: function (e) { void 0 !== e && (void 0 !== e.selector_pager && jQuery(".pager-info", t).html(e.selector_pager), void 0 !== e.selector_rows && (jQuery("ul.learndash-selector-post-listing", t).html(e.selector_rows), jQuery("ul.learndash-selector-post-listing li", t).draggable(n[d]), Q(d))) } }) } } var d, t, i; return !1 }), jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-search input").length) { var t, i = null, o = "", u = null; jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-search input").focus(function (e) { var r = jQuery(e.currentTarget).parents(".learndash-selector-container"); void 0 !== r && (void 0 !== jQuery(r).data("ld-type") && (i = jQuery(this), u = i.width(), console.log("search_width[%o]", u), jQuery(".learndash-selector-pager", r).hide(), jQuery(".learndash-selector-search", r).width("100%"), t = setInterval(function () { var e = i.val(); if (0 == e.length && o != e ? c(r, o = e) : e.length >= 3 && o != e && c(r, o = e), !i.is(":focus")) return clearInterval(t), jQuery(".learndash-selector-pager", r).show(), void jQuery(".learndash-selector-search", r).width(u + "px") }, 250))) }) } } function c(e, l) { if (void 0 !== e && void 0 !== l) { var s = jQuery(e).data("ld-type"); if (void 0 !== s) { var a = { action: "learndash_course_builder_selector_search", course_id: r, query_args: { post_type: s, paged: 1, s: l } }; console.log("search for [%o]", l), jQuery.ajax({ type: "POST", url: ajaxurl, dataType: "json", cache: !1, data: a, error: function (e, r, l) { }, success: function (r) { void 0 !== r && void 0 !== r.selector_rows && (jQuery("ul.learndash-selector-post-listing", e).html(r.selector_rows), jQuery("ul.learndash-selector-post-listing li", e).draggable(n[s]), Q(s)) } }) } } } var n = []; function h(r) { var l = e("<div/>").attr("id", "ld-selector-draggable-group"); if (void 0 !== r && r.length) { var s = 0; jQuery(r).each(function (e, r) { jQuery(".ld-course-builder-sub-actions", r).hide(); var l = jQuery(r).outerWidth(); l > s && (s = l) }), l.css("list-style", "none"), l.css("width", s + "px"), l.append(r.clone()) } return l } n["sfwd-lessons"] = { cancel: ".ld-disabled", handle: ".ld-course-builder-action-lesson-move", connectToSortable: "#learndash_course_builder_box_wrap .ld-course-builder-lesson-items", helper: function () { var r = jQuery("#learndash-selector-post-listing-sfwd-lessons li.ld-selected"); return 0 === r.length && (r = e(this)), h(r) } }, n["sfwd-topic"] = { cancel: ".ld-disabled", handle: ".ld-course-builder-action-topic-move", connectToSortable: "#learndash_course_builder_box_wrap .ld-course-builder-topic-items", helper: function () { var r = jQuery("#learndash-selector-post-listing-sfwd-topic li.ld-selected"); return 0 === r.length && (r = e(this)), h(r) } }, n["sfwd-quiz"] = { cancel: ".ld-disabled", handle: ".ld-course-builder-action-quiz-move", connectToSortable: "#learndash_course_builder_box_wrap .ld-course-builder-quiz-items", helper: function () { var r = jQuery("#learndash-selector-post-listing-sfwd-quiz li.ld-selected"); return 0 === r.length && (r = e(this)), h(r) } }; var _ = []; function b() { l = !0, s = 0; var e = function () { var e = new Object; jQuery("#learndash_course_builder_box_wrap .learndash_builder_items .ld-course-builder-lesson-items").children().each(function (r, l) { var a = jQuery(l).data("ld-id"); s += 1, e["sfwd-lessons:" + a.toString()] = {}, jQuery(".ld-course-builder-lesson-topic-items", l).children().each(function (r, l) { var d = jQuery(l).data("ld-id"); s += 1, e["sfwd-lessons:" + a.toString()]["sfwd-topic:" + d.toString()] = {}, jQuery(".ld-course-builder-topic-quiz-items", l).children().each(function (r, l) { var s = jQuery(l).data("ld-id"); e["sfwd-lessons:" + a.toString()]["sfwd-topic:" + d.toString()]["sfwd-quiz:" + s.toString()] = {} }) }), jQuery(".ld-course-builder-lesson-quiz-items", l).children().each(function (r, l) { var s = jQuery(l).data("ld-id"); e["sfwd-lessons:" + a.toString()]["sfwd-quiz:" + s.toString()] = {} }) }); var r = !1; return jQuery("#learndash_course_builder_box_wrap .learndash_builder_items .ld-course-builder-course-quiz-items").children().each(function (l, s) { var a = jQuery(s).data("ld-id"); r = !0, e["sfwd-quiz:" + a.toString()] = {} }), 1 == r && (s += 1), e }(); jQuery("#learndash_course_builder_box_wrap .learndash_builder_items .ld-course-steps-total .ld-course-steps-value").html(s); var r = JSON.stringify(e); jQuery("#learndash_course_builder_box_wrap input#learndash_course_builder_data").val(r) } _["sfwd-lessons"] = { items: "> div.ld-course-builder-lesson-item", handle: ".ld-course-builder-action-lesson-move", tolerance: "pointer", opacity: .7, revert: 300, delay: 150, dropOnEmpty: !0, placeholder: "movable-placeholder", start: function (e, r) { r.placeholder.height(r.helper.outerHeight()), jQuery("li", r.helper).css("clear", "both"), jQuery("span.ld-course-builder-sub-actions", r.helper).hide() }, stop: function (e, r) { if ("ld-selector-draggable-group" == jQuery(r.item).attr("id")) { var l = "", s = jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-lessons").data("ld-selected"); void 0 === s && (s = []), r.item.children("li").each(function () { var e, r, a = jQuery(this).data("ld-id"); s.push(parseInt(a)), jQuery("span.ld-course-builder-sub-actions", this).hide(), l = l + '<div id="ld-course-builder-lesson-item-' + a + '" class="ld-course-builder-item ld-course-builder-lesson-item" data-ld-type="sfwd-lessons" data-ld-id="' + a + '">' + jQuery(this).html() + "</div>", void 0 !== a && (w("sfwd-lessons", a, !0), r = a, "" === (e = "sfwd-lessons") && "" === r || (!0 === !1 ? jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-" + e + ' ul.learndash-selector-post-listing li[data-ld-id="' + r + '"]').addClass("ld-selected") : jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-" + e + ' ul.learndash-selector-post-listing li[data-ld-id="' + r + '"]').removeClass("ld-selected"))) }), jQuery(r.item).replaceWith(l), jQuery("#learndash_course_builder_box_wrap .ld-course-builder-topic-items").sortable(_["sfwd-topic"]), jQuery("#learndash_course_builder_box_wrap .ld-course-builder-quiz-items").sortable(_["sfwd-quiz"]), s = jQuery.unique(s), jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-lessons").data("ld-selected", s), b() } else jQuery("span.ld-course-builder-sub-actions", r.item).hide(), b() } }, _["sfwd-topic"] = { items: "> div.ld-course-builder-topic-item", handle: ".ld-course-builder-action-topic-move", connectWith: ".ld-course-builder-topic-items", placeholder: "movable-placeholder", tolerance: "pointer", opacity: .7, revert: 300, delay: 150, dropOnEmpty: !0, start: function (e, r) { r.placeholder.height(r.helper.outerHeight()), r.placeholder.width("100%"), jQuery("span.ld-course-builder-sub-actions", r.helper).hide() }, stop: function (e, r) { if ("ld-selector-draggable-group" == jQuery(r.item).attr("id")) { var l = "", s = jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-topic").data("ld-selected"); void 0 === s && (s = []), r.item.children("li").each(function () { var e = jQuery(this).data("ld-id"); s.push(parseInt(e)), jQuery("span.ld-course-builder-sub-actions", this).hide(), l = l + '<div id="ld-course-builder-topic-item-' + e + '" class="ld-course-builder-item ld-course-builder-topic-item" data-ld-type="sfwd-topic" data-ld-id="' + e + '">' + jQuery(this).html() + "</div>", void 0 !== e && (w("sfwd-topic", e, !0), jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-topic li#ld-post-" + e).removeClass("ld-selected")) }), jQuery(r.item).replaceWith(l), jQuery("#learndash_course_builder_box_wrap .ld-course-builder-quiz-items").sortable(_["sfwd-quiz"]), s = jQuery.unique(s), jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-topic").data("ld-selected", s), b() } else jQuery(r.item).addClass("ld-course-builder-item-update"), jQuery("span.ld-course-builder-sub-actions", r.item).hide(), b() } }, _["sfwd-quiz"] = { items: "> div.ld-course-builder-quiz-item", handle: ".ld-course-builder-action-quiz-move", connectWith: ".ld-course-builder-quiz-items", placeholder: "movable-placeholder", tolerance: "pointer", opacity: .7, revert: 300, delay: 150, dropOnEmpty: !0, start: function (e, r) { r.placeholder.height(r.helper.outerHeight()), r.placeholder.width("100%"), jQuery("span.ld-course-builder-sub-actions", r.helper).hide() }, stop: function (e, r) { var l = jQuery(r.item).attr("id"); if ("ld-selector-draggable-group" == l) { var s = "", a = jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-quiz").data("ld-selected"); void 0 === a && (a = []), r.item.children("li").each(function () { var e = jQuery(this).data("ld-id"); a.push(parseInt(e)), jQuery("span.ld-course-builder-sub-actions", this).hide(), s = s + '<div id="ld-course-builder-quiz-item-' + e + '" class="ld-course-builder-item ld-course-builder-quiz-item" data-ld-type="sfwd-quiz" data-ld-id="' + e + '">' + jQuery(this).html() + "</div>", void 0 !== e && (w("sfwd-quiz", e, !0), jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-quiz li#ld-post-" + e).removeClass("ld-selected")) }), jQuery(r.item).replaceWith(s), a = jQuery.unique(a), jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-sfwd-quiz").data("ld-selected", a), b() } else "ld-draggable-builder-group" == l ? r.item.children("div").each(function () { jQuery(this).removeClass("ld-selected") }) : (jQuery(r.item).addClass("ld-course-builder-item-update"), jQuery("span.ld-course-builder-sub-actions", r.item).hide(), b()) } }, jQuery("#learndash_course_builder_box_wrap .learndash_selectors ul#learndash-selector-post-listing-sfwd-lessons li").draggable(n["sfwd-lessons"]), jQuery("#learndash_course_builder_box_wrap .learndash_builder_items .ld-course-builder-lesson-items").sortable(_["sfwd-lessons"]), jQuery("#learndash_course_builder_box_wrap .learndash_selectors ul#learndash-selector-post-listing-sfwd-topic li").draggable(n["sfwd-topic"]), jQuery("#learndash_course_builder_box_wrap .ld-course-builder-topic-items").sortable(_["sfwd-topic"]), jQuery("#learndash_course_builder_box_wrap .learndash_selectors ul#learndash-selector-post-listing-sfwd-quiz li").draggable(n["sfwd-quiz"]), jQuery("#learndash_course_builder_box_wrap .ld-course-builder-quiz-items").sortable(_["sfwd-quiz"]), jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("click", ".ld-course-builder-action-show-hide", function (e, r) { e.stopImmediatePropagation(); var l = jQuery(e.currentTarget).parents(".ld-course-builder-item").first(), s = jQuery(l).find(".ld-course-builder-sub-items").first(); (void 0 === r || "open" != r && "close" != r) && (r = jQuery(s).is(":visible") ? "close" : "open"); "open" == r ? jQuery(s).slideDown("slow", function () { jQuery(e.currentTarget).removeClass("ld-course-builder-action-show"), jQuery(e.currentTarget).addClass("ld-course-builder-action-hide") }) : jQuery(s).slideUp("slow", function () { jQuery(e.currentTarget).addClass("ld-course-builder-action-show"), jQuery(e.currentTarget).removeClass("ld-course-builder-action-hide") }) }), jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("click", ".ld-course-builder-action-remove", function (e) { var r = jQuery(e.currentTarget).closest(".ld-course-builder-item"); if (void 0 === r || "" === r) return; var l = jQuery(r).attr("data-ld-id"), s = jQuery(r).attr("data-ld-type"), a = learndash_course_builder_assets["confirm_remove_" + s]; "" === a && (a = "Confirm delete"); var d = jQuery("span.ld-course-builder-title-text", r).html(); "" !== d && (a += "\r\n\r\n" + d); if (confirm(a)) { var t = jQuery(r).find(".ld-course-builder-item"); void 0 !== t && jQuery(t).each(function (e, r) { var l = jQuery(r).attr("data-ld-type"), s = jQuery(r).attr("data-ld-id"); void 0 !== l && void 0 !== s && w(l, s, !1) }), w(s, l, !1), jQuery(r).remove(), b() } }), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("click", ".ld-course-builder-action-trash", function (e) { var r = jQuery(e.currentTarget).closest("li"); if (void 0 === r || "" === r) return; var l = jQuery(r).attr("data-ld-id"), s = jQuery(r).attr("data-ld-type"), a = learndash_course_builder_assets["confirm_trash_" + s]; "" === a && (a = "Confirm delete"); var d = jQuery("span.ld-course-builder-title-text", r).html(); "" !== d && (a += "\r\n\r\n" + d); if (confirm(a)) { jQuery(r).remove(), v(s); var t = { action: "learndash_course_builder_selector_trash_step", step_args: { post_id: l, post_type: s } }; jQuery.ajax({ type: "POST", url: ajaxurl, dataType: "json", cache: !1, data: t, error: function (e, r, l) { }, success: function (e) { void 0 !== e && e.status } }) } }), window.onbeforeunload = function () { if (!0 === l) return learndash_course_builder_assets.learndash_upload_message }; var p = jQuery("#learndash_course_builder_box_wrap").parents("form"); function y(e) { e.stopImmediatePropagation(); var r = jQuery(e.currentTarget), l = jQuery(".ld-course-builder-sub-actions", r); if (void 0 !== l && void 0 === jQuery(r).closest("div#ld-selector-draggable-group").attr("id")) if (jQuery(l).is(":visible")) "touchstart" == d && jQuery(l).hide(); else { "touchstart" == d && jQuery("#learndash_course_builder_box_wrap .ld-course-builder-sub-actions").hide(); var s = jQuery(r).position(), a = jQuery(r).outerWidth(), t = jQuery(l).outerWidth(); if (jQuery("body").hasClass("rtl")) var i = s.left - t + 5 + "px"; else i = s.left + a + "px"; jQuery(l).css({ "background-color": "#B8B8B8", height: "20px", position: "absolute", top: s.top + "px", left: i }).show() } } function j(e) { var r = jQuery(e.currentTarget), l = jQuery(".ld-course-builder-sub-actions", r); void 0 !== l && jQuery(l).hide() } function Q(e, r) { if ("" !== e) { var l = jQuery('#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container[data-ld-type="' + e + '"]'); if (void 0 !== l) { var s = jQuery(l).data("ld-selected"); void 0 !== s && s.length && jQuery.each(s, function (r, l) { w(e, l, !0) }) } } } function v(e) { if ("" !== e) { var r = jQuery('#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container[data-ld-type="' + e + '"]'); jQuery("ul#learndash-selector-post-listing-" + e + " li", r).length ? (jQuery(".learndash-selector-pager", r).show(), jQuery(".learndash-selector-search", r).show()) : (jQuery(".learndash-selector-pager", r).hide(), jQuery(".learndash-selector-search", r).hide()) } } function w(e, r, l) { if ("" !== e && "" !== r) { var s = jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-" + e).data("ld-selected"); void 0 === s && (s = []); var a = !1; !0 === l ? (jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-" + e + ' ul.learndash-selector-post-listing li[data-ld-id="' + r + '"]').addClass("ld-disabled"), -1 === s.indexOf(parseInt(r)) && (s.push(parseInt(r)), a = !0)) : (jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-" + e + ' ul.learndash-selector-post-listing li[data-ld-id="' + r + '"]').removeClass("ld-disabled"), s = s.filter(function (e) { return e !== parseInt(r) }), a = !0), 1 == a && jQuery("#learndash_course_builder_box_wrap .learndash_selectors .learndash-selector-container-" + e).data("ld-selected", s) } } void 0 !== p && jQuery(p).submit(function () { l = !1 }), "hover" == d ? (jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("mouseover", ".ld-course-builder-actions", y), jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("mouseleave", ".ld-course-builder-actions", j), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("mouseover", ".ld-course-builder-actions", y), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("mouseleave", ".ld-course-builder-actions", j)) : "touchstart" == d && (jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("click", ".ld-course-builder-actions", y), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("click", ".ld-course-builder-actions", y)), jQuery("#learndash_course_builder_box_wrap").on("mouseover", ".ld-course-builder-title", function (e) { e.stopImmediatePropagation(); var r = !0, l = jQuery(e.currentTarget).closest(".ld-course-builder-item")[0]; void 0 !== l && (jQuery(l).hasClass("ld-disabled") && (r = !1), jQuery(l).hasClass("ld-course-builder-title-edit") && (r = !1), 1 == r && jQuery(".ld-course-builder-edit-title-pencil", e.currentTarget).show()) }), jQuery("#learndash_course_builder_box_wrap").on("mouseleave", ".ld-course-builder-title", function (e) { e.stopImmediatePropagation(), jQuery(".ld-course-builder-edit-title-pencil", e.currentTarget).hide() }), jQuery("#learndash_course_builder_box_wrap").on("click", ".ld-course-builder-title", function (e) { e.stopImmediatePropagation(); var r = e.currentTarget, l = jQuery(r).parents(".ld-course-builder-item"); if (void 0 !== l) { if (jQuery(l).hasClass("ld-disabled")) return; if (jQuery(l).hasClass("ld-course-builder-title-edit")) return; jQuery(l).addClass("ld-course-builder-title-edit"), jQuery(l).hasClass("ld-selected") && jQuery(l).removeClass("ld-selected"), jQuery(".ld-course-builder-actions", l).hide(); var s = jQuery(".ld-course-builder-title-text", r).html(); function a(e) { e.stopImmediatePropagation(); var l = jQuery(e.currentTarget).parents(".ld-course-builder-item"); jQuery(l).removeClass("ld-course-builder-title-edit"); var a = jQuery(".ld-course-builder-title-text input", r).val(); if (jQuery(".ld-course-builder-title-text input", r).remove(), jQuery(".ld-course-builder-edit-title-ok", r).hide(), jQuery(".ld-course-builder-edit-title-cancel", r).hide(), jQuery(".ld-course-builder-actions", l).show(), "" != a && a != s) { jQuery(".ld-course-builder-title-text", r).html(a); var l = jQuery(r).parents(".ld-course-builder-item"); if (void 0 !== l) { var d = jQuery(l).data("ld-id"), t = jQuery(l).data("ld-type"), i = { action: "learndash_course_builder_selector_set_step_title", new_title: a, step_args: { post_id: d, post_type: t } }; jQuery.ajax({ type: "POST", url: ajaxurl, dataType: "json", cache: !1, data: i, error: function (e, r, l) { }, success: function (e) { if (void 0 !== e.status && !0 === e.status) { var r = jQuery("#learndash_course_builder_box_wrap .learndash_selectors li#ld-post-" + d); jQuery(".ld-course-builder-title-text", r).html(a); var l = jQuery("#learndash_course_builder_box_wrap .learndash_builder_items #ld-post-" + d); jQuery(".ld-course-builder-title-text", l).first().html(a) } } }) } } else jQuery(".ld-course-builder-title-text", r).html(s) } jQuery(".ld-course-builder-title-text", r).html('<input type="text" value="' + s + '" />'), jQuery(".ld-course-builder-title-text input", r).focus(), jQuery(".ld-course-builder-title-text input", r).select(), jQuery(".ld-course-builder-edit-title-pencil", r).hide(), jQuery(".ld-course-builder-edit-title-ok", r).show(), jQuery(".ld-course-builder-edit-title-cancel", r).show(), jQuery(r).on("click", ".ld-course-builder-edit-title-ok", function (e) { a(e) }), jQuery(r).on("keypress", ":focus", function (e) { 13 == e.keyCode && a(e) }), jQuery(r).on("click", ".ld-course-builder-edit-title-cancel", function (e) { e.stopImmediatePropagation(); var l = jQuery(e.currentTarget).parents(".ld-course-builder-item"); if (jQuery(l).removeClass("ld-course-builder-title-edit"), jQuery(".ld-course-builder-title-text input", r).remove(), jQuery(".ld-course-builder-edit-title-ok", r).hide(), jQuery(".ld-course-builder-edit-title-cancel", r).hide(), jQuery(".ld-course-builder-actions", l).show(), jQuery(".ld-course-builder-action-show-hide", l).length) { var a = function (e) { if (void 0 !== e) { var r = jQuery(e).closest(".learndash_selectors"); if (void 0 !== r && r.length > 0) return r[0]; var l = jQuery(e).closest(".learndash_builder_items"); if (void 0 !== l && l.length > 0) return l[0] } }(l); void 0 !== a && jQuery(a).hasClass("learndash_builder_items") && jQuery(".ld-course-builder-action-show-hide", l).show() } jQuery(".ld-course-builder-title-text", r).html(s) }) } }), jQuery(".learndash_selectors").on("click", ".ld-course-builder-action-add", function (e) { if (e.stopImmediatePropagation(), !jQuery(e.currentTarget).hasClass("ld-course-builder-action-add-pending")) { jQuery(e.currentTarget).addClass("ld-course-builder-action-add-pending"); var r = jQuery(e.currentTarget).closest(".learndash-selector-container"); if (void 0 !== r) { var l = jQuery(r).find(".ld-course-builder-action-show-hide"); jQuery(l).hasClass("ld-course-builder-action-show") && jQuery(".ld-course-builder-action-show-hide", r).trigger("click", ["open"]); var s = jQuery(r).data("ld-type"); if (void 0 !== s) { var d = new Date, t = d.getTime(), i = "new-step-" + t, o = jQuery(".learndash-row-placeholder li", r).clone(); jQuery(o).attr("id", i), jQuery(o).attr("data-ld-id", ""), jQuery(o).removeClass("ld-disabled"), jQuery(o).removeClass("ld-selected"), jQuery(o).removeClass("ld-course-builder-title-edit"), jQuery(o).addClass("ld-new-step"); var u = jQuery(".ld-course-builder-header .ld-course-builder-title", o); jQuery(u).hasClass("ld-course-builder-title-edit") && jQuery('input[type="text"]', u).length && jQuery('input[type="text"]', u).remove(), jQuery("#learndash_course_builder_box_wrap .learndash_selectors ul#learndash-selector-post-listing-" + s).prepend(o), jQuery("#learndash_course_builder_box_wrap .learndash_selectors ul#learndash-selector-post-listing-" + s + " li").draggable(n[s]), jQuery("#learndash_course_builder_box_wrap #" + i + " .ld-course-builder-title-text").trigger("click"), v(s), function e() { if ("" == a && jQuery("#learndash_course_builder_box_wrap .ld-new-step").length) { var r = {}; if (jQuery("#learndash_course_builder_box_wrap .ld-new-step").each(function (e, l) { var s = {}; s.item_id = jQuery(l).attr("id"), s.post_type = jQuery(l).data("ld-type"), jQuery('input[type="text"]', l).length ? s.post_title = jQuery('input[type="text"]', l).val() : s.post_title = jQuery(".ld-course-builder-title-text", l).val(), r[s.item_id] = s }), Object.keys(r).length > 0) { var l = { action: "learndash_course_builder_selector_new_step", new_steps: r }; a = jQuery.ajax({ type: "POST", url: ajaxurl, dataType: "json", cache: !1, data: l, error: function (e, r, l) { }, success: function (r) { void 0 !== r && void 0 !== r.new_steps && jQuery.each(r.new_steps, function (e, r) { jQuery("#learndash_course_builder_box_wrap #" + e).length && jQuery("#learndash_course_builder_box_wrap #" + e).hasClass("ld-new-step") && (jQuery("#learndash_course_builder_box_wrap #" + e).removeClass("ld-new-step"), jQuery("#learndash_course_builder_box_wrap #" + e).attr("data-ld-id", r.post_id), jQuery("#learndash_course_builder_box_wrap #" + e + " a.ld-course-builder-action-view").attr("href", r.view_url.replace(/&amp;/g, "&")), jQuery("#learndash_course_builder_box_wrap #" + e + " a.ld-course-builder-action-edit").attr("href", r.edit_url.replace(/&amp;/g, "&")), jQuery("#learndash_course_builder_box_wrap #" + e).attr("id", "ld-post-" + r.post_id)) }), a = "", e() } }) } } }(), jQuery(e.currentTarget).removeClass("ld-course-builder-action-add-pending") } } } }), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("click", ".ld-show-all", function (e) { jQuery("#learndash_course_builder_box_wrap .learndash_selectors h3.learndash-selector-header .ld-course-builder-action-show-hide").trigger("click", ["open"]) }), jQuery("#learndash_course_builder_box_wrap .learndash_selectors").on("click", ".ld-hide-all", function (e) { jQuery("#learndash_course_builder_box_wrap .learndash_selectors h3.learndash-selector-header .ld-course-builder-action-show-hide").trigger("click", ["close"]) }), jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("click", ".ld-show-all", function (e) { jQuery("#learndash_course_builder_box_wrap .learndash_builder_items .ld-course-builder-action-show-hide").trigger("click", ["open"]) }), jQuery("#learndash_course_builder_box_wrap .learndash_builder_items").on("click", ".ld-hide-all", function (e) { jQuery("#learndash_course_builder_box_wrap .learndash_builder_items .ld-course-builder-action-show-hide").trigger("click", ["close"]) }) });